#!/bin/bash

#CUDA_VISIBLE_DEVICES=0,1,2,3 python -m torch.distributed.launch --nproc_per_node=4 /home/irving/federated_matching/FedMA/Semantic_Segmentation/save_weights.py --n_=2 --init_same=True --model=unet --bilinear=True --dataset=carvana --n_channels=3 --n_classes=1 --batch_size=8 --lr=0.0001 --epochs=2 --trials=10
python /home/irving/federated_matching/probabilistic_federated_matching_KL/save_weights.py --layers 0 --n 5 10 15 20 --experiment "pdm_KL" --dataset "cifar10" --num_pool_workers 4 --trials 10 --model 'simple-cnn' --retrain True --epochs 30 --retrain_epochs 10 --batch_size 64 --lr 0.01 --retrain_lr 0.01 --reg 0 --device 1 --init_same True