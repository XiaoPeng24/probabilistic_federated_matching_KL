08-25 21:52 DEBUG    Experiment arguments: Namespace(alpha=0.5, communication_rounds=5, datadir='data/mnist/', dataset='mnist', dropout_p=0.0, epochs=10, experiment=['u-ensemble', 'pdm', 'pdm_KL', 'pdm_KL2'], init_seed=0, iter_epochs=5, logdir='logs/mnist_test8', lr=0.01, lr_decay=0.99, n_nets=10, net_config=[784, 100, 10], partition='hetero-dir', pdm_gamma=1.0, pdm_sig=1.0, pdm_sig0=1.0, reg=1e-06, reg_fac=0.0, trials=1)
08-25 21:52 DEBUG    ####################################################################################################
08-25 21:52 DEBUG    Executing Trial 0 with seed 0
08-25 21:52 DEBUG    Data statistics: {0: {0: 602, 2: 796, 3: 948, 4: 477, 5: 120, 6: 546, 7: 191, 8: 143, 9: 1650}, 1: {0: 820, 1: 2411, 2: 2824}, 2: {0: 770, 1: 25, 2: 669, 3: 963, 4: 2734, 5: 28, 6: 7, 7: 16, 8: 602, 9: 663}, 3: {0: 237, 1: 923, 2: 396, 3: 273, 4: 609, 5: 240, 6: 468, 7: 150, 8: 2975}, 4: {0: 241, 1: 409, 2: 58, 3: 1175, 4: 425, 5: 64, 6: 88, 7: 55, 8: 100, 9: 670}, 5: {0: 103, 1: 356, 3: 10, 4: 474, 5: 29, 6: 2121, 7: 554, 8: 888, 9: 2934}, 6: {0: 1430, 1: 2487, 2: 58, 3: 266, 4: 650, 5: 551, 6: 128, 7: 2929}, 7: {0: 554, 1: 1, 2: 160, 3: 51, 5: 1511, 6: 2451, 7: 1609}, 8: {0: 234, 1: 100, 2: 867, 3: 1177, 4: 77, 5: 2396, 6: 92, 7: 646, 8: 1133}, 9: {0: 932, 1: 30, 2: 130, 3: 1268, 4: 396, 5: 482, 6: 17, 7: 115, 8: 10, 9: 32}}
08-25 21:52 DEBUG    Training network 0
08-25 21:52 DEBUG    n_training: 172
08-25 21:52 DEBUG    n_test: 313
08-25 21:52 DEBUG    >> Pre-Training Training accuracy: 0.067605
08-25 21:52 DEBUG    >> Pre-Training Test accuracy: 0.110600
08-25 21:52 DEBUG    Epoch: 0 Loss: 0.001784 L2 loss: 0.000570
08-25 21:52 DEBUG    Epoch: 1 Loss: 0.245783 L2 loss: 0.000820
08-25 21:52 DEBUG    Epoch: 2 Loss: 0.047751 L2 loss: 0.001081
08-25 21:52 DEBUG    Epoch: 3 Loss: 0.035987 L2 loss: 0.001268
08-25 21:52 DEBUG    Epoch: 4 Loss: 0.008193 L2 loss: 0.001427
08-25 21:52 DEBUG    Epoch: 5 Loss: 0.001629 L2 loss: 0.001560
08-25 21:52 DEBUG    Epoch: 6 Loss: 0.001697 L2 loss: 0.001687
08-25 21:52 DEBUG    Epoch: 7 Loss: 0.001984 L2 loss: 0.001958
08-25 21:52 DEBUG    Epoch: 8 Loss: 0.002321 L2 loss: 0.002296
08-25 21:52 DEBUG    Epoch: 9 Loss: 0.002586 L2 loss: 0.002586
08-25 21:52 DEBUG    >> Training accuracy: 0.976795
08-25 21:52 DEBUG    >> Test accuracy: 0.794600
08-25 21:52 DEBUG     ** Training complete **
08-25 21:52 DEBUG    Training network 1
08-25 21:52 DEBUG    n_training: 190
08-25 21:52 DEBUG    n_test: 313
08-25 21:52 DEBUG    >> Pre-Training Training accuracy: 0.051363
08-25 21:52 DEBUG    >> Pre-Training Test accuracy: 0.117000
08-25 21:52 DEBUG    Epoch: 0 Loss: 0.381585 L2 loss: 0.000447
08-25 21:52 DEBUG    Epoch: 1 Loss: 0.000662 L2 loss: 0.000588
08-25 21:52 DEBUG    Epoch: 2 Loss: 0.000702 L2 loss: 0.000692
08-25 21:52 DEBUG    Epoch: 3 Loss: 0.000791 L2 loss: 0.000786
08-25 21:52 DEBUG    Epoch: 4 Loss: 0.000992 L2 loss: 0.000984
08-25 21:52 DEBUG    Epoch: 5 Loss: 0.001091 L2 loss: 0.001076
08-25 21:52 DEBUG    Epoch: 6 Loss: 0.001077 L2 loss: 0.001076
08-25 21:52 DEBUG    Epoch: 7 Loss: 0.001140 L2 loss: 0.001066
08-25 21:52 DEBUG    Epoch: 8 Loss: 0.001052 L2 loss: 0.001052
08-25 21:52 DEBUG    Epoch: 9 Loss: 0.001236 L2 loss: 0.001037
08-25 21:52 DEBUG    >> Training accuracy: 1.000000
08-25 21:52 DEBUG    >> Test accuracy: 0.313000
08-25 21:52 DEBUG     ** Training complete **
08-25 21:52 DEBUG    Training network 2
08-25 21:52 DEBUG    n_training: 203
08-25 21:52 DEBUG    n_test: 313
08-25 21:52 DEBUG    >> Pre-Training Training accuracy: 0.113324
08-25 21:52 DEBUG    >> Pre-Training Test accuracy: 0.137100
08-25 21:52 DEBUG    Epoch: 0 Loss: 0.123752 L2 loss: 0.000564
08-25 21:52 DEBUG    Epoch: 1 Loss: 0.240904 L2 loss: 0.000817
08-25 21:52 DEBUG    Epoch: 2 Loss: 0.420073 L2 loss: 0.001076
08-25 21:52 DEBUG    Epoch: 3 Loss: 0.014215 L2 loss: 0.001282
08-25 21:52 DEBUG    Epoch: 4 Loss: 0.008710 L2 loss: 0.001478
08-25 21:52 DEBUG    Epoch: 5 Loss: 0.050619 L2 loss: 0.001701
08-25 21:52 DEBUG    Epoch: 6 Loss: 0.024816 L2 loss: 0.002051
08-25 21:52 DEBUG    Epoch: 7 Loss: 0.342572 L2 loss: 0.002339
08-25 21:52 DEBUG    Epoch: 8 Loss: 0.002670 L2 loss: 0.002670
08-25 21:52 DEBUG    Epoch: 9 Loss: 0.005709 L2 loss: 0.002847
08-25 21:52 DEBUG    >> Training accuracy: 0.997684
08-25 21:52 DEBUG    >> Test accuracy: 0.779200
08-25 21:52 DEBUG     ** Training complete **
08-25 21:52 DEBUG    Training network 3
08-25 21:52 DEBUG    n_training: 196
08-25 21:52 DEBUG    n_test: 313
08-25 21:52 DEBUG    >> Pre-Training Training accuracy: 0.127890
08-25 21:52 DEBUG    >> Pre-Training Test accuracy: 0.100200
08-25 21:52 DEBUG    Epoch: 0 Loss: 0.207108 L2 loss: 0.000525
08-25 21:52 DEBUG    Epoch: 1 Loss: 0.080480 L2 loss: 0.000765
08-25 21:52 DEBUG    Epoch: 2 Loss: 0.053146 L2 loss: 0.000970
08-25 21:52 DEBUG    Epoch: 3 Loss: 0.033884 L2 loss: 0.001196
08-25 21:52 DEBUG    Epoch: 4 Loss: 0.482674 L2 loss: 0.001370
08-25 21:53 DEBUG    Epoch: 5 Loss: 0.028509 L2 loss: 0.001565
08-25 21:53 DEBUG    Epoch: 6 Loss: 0.243673 L2 loss: 0.001727
08-25 21:53 DEBUG    Epoch: 7 Loss: 0.165128 L2 loss: 0.001860
08-25 21:53 DEBUG    Epoch: 8 Loss: 0.002806 L2 loss: 0.001982
08-25 21:53 DEBUG    Epoch: 9 Loss: 0.002211 L2 loss: 0.002087
08-25 21:53 DEBUG    >> Training accuracy: 0.996970
08-25 21:53 DEBUG    >> Test accuracy: 0.833300
08-25 21:53 DEBUG     ** Training complete **
08-25 21:53 DEBUG    Training network 4
08-25 21:53 DEBUG    n_training: 103
08-25 21:53 DEBUG    n_test: 313
08-25 21:53 DEBUG    >> Pre-Training Training accuracy: 0.034094
08-25 21:53 DEBUG    >> Pre-Training Test accuracy: 0.104700
08-25 21:53 DEBUG    Epoch: 0 Loss: 0.200947 L2 loss: 0.000433
08-25 21:53 DEBUG    Epoch: 1 Loss: 0.148828 L2 loss: 0.000576
08-25 21:53 DEBUG    Epoch: 2 Loss: 0.072271 L2 loss: 0.000724
08-25 21:53 DEBUG    Epoch: 3 Loss: 0.030274 L2 loss: 0.000826
08-25 21:53 DEBUG    Epoch: 4 Loss: 0.037921 L2 loss: 0.000953
08-25 21:53 DEBUG    Epoch: 5 Loss: 0.311978 L2 loss: 0.001019
08-25 21:53 DEBUG    Epoch: 6 Loss: 0.020638 L2 loss: 0.001117
08-25 21:53 DEBUG    Epoch: 7 Loss: 0.001526 L2 loss: 0.001226
08-25 21:53 DEBUG    Epoch: 8 Loss: 0.076930 L2 loss: 0.001357
08-25 21:53 DEBUG    Epoch: 9 Loss: 0.001862 L2 loss: 0.001404
08-25 21:53 DEBUG    >> Training accuracy: 0.999696
08-25 21:53 DEBUG    >> Test accuracy: 0.883100
08-25 21:53 DEBUG     ** Training complete **
08-25 21:53 DEBUG    Training network 5
08-25 21:53 DEBUG    n_training: 234
08-25 21:53 DEBUG    n_test: 313
08-25 21:53 DEBUG    >> Pre-Training Training accuracy: 0.023162
08-25 21:53 DEBUG    >> Pre-Training Test accuracy: 0.102300
08-25 21:53 DEBUG    Epoch: 0 Loss: 0.354009 L2 loss: 0.000591
08-25 21:53 DEBUG    Epoch: 1 Loss: 0.002852 L2 loss: 0.000903
08-25 21:53 DEBUG    Epoch: 2 Loss: 0.449446 L2 loss: 0.001165
08-25 21:53 DEBUG    Epoch: 3 Loss: 0.343460 L2 loss: 0.001374
08-25 21:53 DEBUG    Epoch: 4 Loss: 0.014093 L2 loss: 0.001577
08-25 21:53 DEBUG    Epoch: 5 Loss: 0.357031 L2 loss: 0.001755
08-25 21:53 DEBUG    Epoch: 6 Loss: 0.004640 L2 loss: 0.001970
08-25 21:53 DEBUG    Epoch: 7 Loss: 0.003834 L2 loss: 0.002050
08-25 21:53 DEBUG    Epoch: 8 Loss: 0.002161 L2 loss: 0.002079
08-25 21:53 DEBUG    Epoch: 9 Loss: 0.004834 L2 loss: 0.002138
08-25 21:53 DEBUG    >> Training accuracy: 0.994645
08-25 21:53 DEBUG    >> Test accuracy: 0.751000
08-25 21:53 DEBUG     ** Training complete **
08-25 21:53 DEBUG    Training network 6
08-25 21:53 DEBUG    n_training: 266
08-25 21:53 DEBUG    n_test: 313
08-25 21:53 DEBUG    >> Pre-Training Training accuracy: 0.136604
08-25 21:53 DEBUG    >> Pre-Training Test accuracy: 0.113500
08-25 21:53 DEBUG    Epoch: 0 Loss: 0.094850 L2 loss: 0.000642
08-25 21:53 DEBUG    Epoch: 1 Loss: 0.105649 L2 loss: 0.000914
08-25 21:53 DEBUG    Epoch: 2 Loss: 0.059641 L2 loss: 0.001209
08-25 21:53 DEBUG    Epoch: 3 Loss: 0.034530 L2 loss: 0.001459
08-25 21:53 DEBUG    Epoch: 4 Loss: 0.010798 L2 loss: 0.001603
08-25 21:53 DEBUG    Epoch: 5 Loss: 0.301502 L2 loss: 0.001893
08-25 21:53 DEBUG    Epoch: 6 Loss: 0.005330 L2 loss: 0.002159
08-25 21:53 DEBUG    Epoch: 7 Loss: 0.007696 L2 loss: 0.002415
08-25 21:53 DEBUG    Epoch: 8 Loss: 0.054309 L2 loss: 0.002482
08-25 21:53 DEBUG    Epoch: 9 Loss: 0.020953 L2 loss: 0.002529
08-25 21:53 DEBUG    >> Training accuracy: 0.999059
08-25 21:53 DEBUG    >> Test accuracy: 0.741000
08-25 21:53 DEBUG     ** Training complete **
08-25 21:53 DEBUG    Training network 7
08-25 21:53 DEBUG    n_training: 199
08-25 21:53 DEBUG    n_test: 313
08-25 21:53 DEBUG    >> Pre-Training Training accuracy: 0.054284
08-25 21:53 DEBUG    >> Pre-Training Test accuracy: 0.081200
08-25 21:53 DEBUG    Epoch: 0 Loss: 0.000543 L2 loss: 0.000543
08-25 21:53 DEBUG    Epoch: 1 Loss: 0.030611 L2 loss: 0.000764
08-25 21:53 DEBUG    Epoch: 2 Loss: 0.000982 L2 loss: 0.000959
08-25 21:53 DEBUG    Epoch: 3 Loss: 0.001164 L2 loss: 0.001133
08-25 21:53 DEBUG    Epoch: 4 Loss: 0.001258 L2 loss: 0.001258
08-25 21:53 DEBUG    Epoch: 5 Loss: 0.001629 L2 loss: 0.001458
08-25 21:53 DEBUG    Epoch: 6 Loss: 0.001571 L2 loss: 0.001571
08-25 21:53 DEBUG    Epoch: 7 Loss: 0.001738 L2 loss: 0.001738
08-25 21:53 DEBUG    Epoch: 8 Loss: 0.001888 L2 loss: 0.001888
08-25 21:54 DEBUG    Epoch: 9 Loss: 0.001974 L2 loss: 0.001974
08-25 21:54 DEBUG    >> Training accuracy: 0.997633
08-25 21:54 DEBUG    >> Test accuracy: 0.540900
08-25 21:54 DEBUG     ** Training complete **
08-25 21:54 DEBUG    Training network 8
08-25 21:54 DEBUG    n_training: 211
08-25 21:54 DEBUG    n_test: 313
08-25 21:54 DEBUG    >> Pre-Training Training accuracy: 0.102946
08-25 21:54 DEBUG    >> Pre-Training Test accuracy: 0.101200
08-25 21:54 DEBUG    Epoch: 0 Loss: 0.010394 L2 loss: 0.000615
08-25 21:54 DEBUG    Epoch: 1 Loss: 0.063586 L2 loss: 0.000864
08-25 21:54 DEBUG    Epoch: 2 Loss: 0.009038 L2 loss: 0.001104
08-25 21:54 DEBUG    Epoch: 3 Loss: 0.003489 L2 loss: 0.001356
08-25 21:54 DEBUG    Epoch: 4 Loss: 0.001600 L2 loss: 0.001598
08-25 21:54 DEBUG    Epoch: 5 Loss: 0.229278 L2 loss: 0.001813
08-25 21:54 DEBUG    Epoch: 6 Loss: 0.002087 L2 loss: 0.002086
08-25 21:54 DEBUG    Epoch: 7 Loss: 0.002407 L2 loss: 0.002299
08-25 21:54 DEBUG    Epoch: 8 Loss: 0.002443 L2 loss: 0.002442
08-25 21:54 DEBUG    Epoch: 9 Loss: 0.002787 L2 loss: 0.002650
08-25 21:54 DEBUG    >> Training accuracy: 0.988099
08-25 21:54 DEBUG    >> Test accuracy: 0.841000
08-25 21:54 DEBUG     ** Training complete **
08-25 21:54 DEBUG    Training network 9
08-25 21:54 DEBUG    n_training: 107
08-25 21:54 DEBUG    n_test: 313
08-25 21:54 DEBUG    >> Pre-Training Training accuracy: 0.058910
08-25 21:54 DEBUG    >> Pre-Training Test accuracy: 0.107400
08-25 21:54 DEBUG    Epoch: 0 Loss: 0.143699 L2 loss: 0.000434
08-25 21:54 DEBUG    Epoch: 1 Loss: 0.200029 L2 loss: 0.000568
08-25 21:54 DEBUG    Epoch: 2 Loss: 0.130838 L2 loss: 0.000689
08-25 21:54 DEBUG    Epoch: 3 Loss: 0.039915 L2 loss: 0.000789
08-25 21:54 DEBUG    Epoch: 4 Loss: 0.006540 L2 loss: 0.000942
08-25 21:54 DEBUG    Epoch: 5 Loss: 0.002504 L2 loss: 0.001032
08-25 21:54 DEBUG    Epoch: 6 Loss: 0.001799 L2 loss: 0.001188
08-25 21:54 DEBUG    Epoch: 7 Loss: 0.061889 L2 loss: 0.001277
08-25 21:54 DEBUG    Epoch: 8 Loss: 0.003209 L2 loss: 0.001419
08-25 21:54 DEBUG    Epoch: 9 Loss: 0.009396 L2 loss: 0.001462
08-25 21:54 DEBUG    >> Training accuracy: 0.998535
08-25 21:54 DEBUG    >> Test accuracy: 0.818600
08-25 21:54 DEBUG     ** Training complete **
08-25 21:54 DEBUG    **************************************************
08-25 21:54 DEBUG    Running experiments 

08-25 21:54 DEBUG    Uniform ensemble (Train acc): 0.959000
08-25 21:54 DEBUG    Uniform ensemble (Test acc): 0.957000
08-25 21:55 DEBUG    ****** PDM matching ******** 
08-25 21:55 DEBUG    Best Sigma0: 1. Best sigma: 1 Best gamma: 1. Best Test accuracy: 0.9165. Train acc: 0.9156. 

08-25 21:55 DEBUG    PDM log: {(1, 1, 1): {'shapes': [(784, 387), (387,), (387, 10), (10,)], 'train_accuracy': 0.9156, 'test_accuracy': 0.9165}} 
08-25 21:55 DEBUG    ****** PDM_KL matching ******** 
08-25 21:55 DEBUG    Best Sigma0: 1. Best sigma: 1 Best gamma: 1. Best Test accuracy: 0.8571. Train acc: 0.8600833333333333. 

08-25 21:55 DEBUG    PDM_KL log: {(1, 1, 1): {'shapes': [(784, 151), (151,), (151, 10), (10,)], 'train_accuracy': 0.8600833333333333, 'test_accuracy': 0.8571}} 
08-25 21:57 DEBUG    ****** PDM_KL2 matching ******** 
08-25 21:57 DEBUG    Best Sigma0: 1. Best sigma: 1 Best gamma: 1. Best Test accuracy: 0.9048. Train acc: 0.90325. 

08-25 21:57 DEBUG    PDM_KL2 log: {(1, 1, 1): {'shapes': [(784, 506), (506,), (506, 10), (10,)], 'train_accuracy': 0.90325, 'test_accuracy': 0.9048}} 
08-25 21:57 DEBUG    Trial 0 completed
08-25 21:57 DEBUG    ####################################################################################################
